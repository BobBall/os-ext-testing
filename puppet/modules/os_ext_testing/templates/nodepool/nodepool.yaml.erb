script-dir: /etc/nodepool/scripts

dburi: 'mysql://nodepool:<%= mysql_password %>@localhost/nodepool'

cron:
  cleanup: '*/1 * * * *'
  check: '*/15 * * * *'
  image-update: '12 14 * * *'

zmq-publishers:
  - tcp://localhost:8888

gearman-servers:
  - host: <%= gearman_server %>

labels:
  - name: ds-xen
    image: ds-xen
    min-ready: 2
    providers:
      - name: rax-iad

providers:
#  - name: rax-ord
#    region-name: 'ORD'
#    service-type: 'compute'
#    service-name: 'cloudServersOpenStack'
#    username: '<%= provider_username %>'
#    password: '<%= provider_password %>'
#    project-id: '874240'
#    auth-url: 'https://identity.api.rackspacecloud.com/v2.0/'
#    boot-timeout: 600
#    max-servers: 2
#    keypair: 'xenproject-nodepool'
#    name-filter: 'Performance'
#    template-hostname: '{image.name}-{timestamp}.template.xen.org'
#    images:
#      - name: ds-xen
#        # This is the image name to use found in this provider's `glance image-list`
#        base-image: '<%= provider_image_name %>'
#        min-ram: 8192
#        # This is the script that will be used to prepare the image
#        setup: <%= provider_image_setup_script_name %>
#        #Set the public key part only of the jenkin's key (no whitespace) to the NODEPOOL_SSH_KEY environment variable in order to
#        #inject it into the image's jenkins user .ssh/authorized_keys
#        #This key will be used to log in and setup jenkins on the target VM
#        private-key: '/home/nodepool/.ssh/id_rsa'
#        config-drive: true
  - name: rax-iad
    region-name: 'IAD'
    service-type: 'compute'
    service-name: 'cloudServersOpenStack'
    username: '<%= provider_username %>'
    password: '<%= provider_password %>'
    project-id: '874240'
    auth-url: 'https://identity.api.rackspacecloud.com/v2.0/'
    boot-timeout: 600
    max-servers: 5
    rate: 10.0
    keypair: 'xenproject-nodepool'
    template-hostname: '{image.name}-{timestamp}.template.xen.org'
    images:
      - name: ds-xen
        # This is the image name to use found in this provider's `glance image-list`
        base-image: '<%= provider_image_name %>'
        min-ram: 8192
        name-filter: 'Performance'
        # This is the script that will be used to prepare the image
        setup: <%= provider_image_setup_script_name %>
        #Set the public key part only of the jenkin's key (no whitespace) to the NODEPOOL_SSH_KEY environment variable in order to
        #inject it into the image's jenkins user .ssh/authorized_keys
        #This key will be used to log in and setup jenkins on the target VM
        private-key: '/home/nodepool/.ssh/id_rsa'
        config-drive: true
        meta:
            xenapi_use_agent: 'false'


targets:
  - name: local-jenkins
    jenkins:
      url: 'http://localhost:8080/'
      user: '<%= jenkins_api_user %>'
      apikey: '<%= jenkins_api_key %>'
      credentials-id: '<%= jenkins_credentials_id %>'
